<property name="path" default="index.html" attribute />

<template>
  <article id="content">
    Loading...
  </article>
</template>

<script>
  import { marked } from 'https://unpkg.com/marked@5.0.2/lib/marked.esm.js';
  import { escape } from 'https://unpkg.com/html-escaper@3.0.3/min.js';

  export default function ({ root, el, props, $ }) {
    console.error(escapeHtml.html);
    const codeRenderer = (attr) => {
      const {text, lang, type, escape} = attr;
      return `<doc-code lang="${lang}">${escapeHtml.escape(type)}</doc-code>`;
    }
  

    marked.use({
      extensions: [{
        name: 'code',
        renderer: codeRenderer
      }]
    });

    props.path.watch(path => {
      console.error(path);
      fetch(`docs/${path}`)
        .then(response => response.text())
        .then(text => {
          el.content.innerHTML = marked(text);
        })
        .catch(console.error)
    });
  };
</script>

<style>
  :host {
    padding: 20px;
    max-width: 800px;    
    margin: 0 auto;
    color: var(--foreground);
  }

  a {
    color: var(--foreground2);
  }

  h1 { font-size: 2em }
  h2 { font-size: 1.6em }
  h3 { font-size: 1.3em }
  h4 { font-size: 1.2em }

</style>